# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/isicufesdermnet_dataloading.ipynb.

# %% auto 0
__all__ = ['get_bt_isicufesdermnet_train_dls']

# %% ../nbs/isicufesdermnet_dataloading.ipynb 2
#directory = "/content/drive/MyDrive/ISIC_2019_Training_Input/"

# %% ../nbs/isicufesdermnet_dataloading.ipynb 4
from fastai.vision.all import *
# from self_supervised.augmentations import *
# from self_supervised.layers import *
from .utils import *
import os


# %% ../nbs/isicufesdermnet_dataloading.ipynb 13
def get_bt_isicufesdermnet_train_dls(bs,
                          size, #not needed
                          device,
                          pct_dataset=1.0,
                          num_workers=12):

    dataset_dir = "/content/isic_dataset" #hardcoded for ssl.
    combined_resized_dir = os.path.join(dataset_dir, "ISIC_2019_TrainingValid_Resized")
    fnames_isic = get_image_files(combined_resized_dir)

    fnames_ufes=[]
    for i in [1,2,3]:
        fnames_ufes+=get_image_files(f"/content/PAD_UFES_20_resized/imgs_part_{i}/imgs_part_{i}")

    base_train_dir = "/content/DermNetDataset/train"
    base_test_dir = "/content/DermNetDataset/test"
    fnames_train = get_image_files(base_train_dir)
    fnames_test = get_image_files(base_test_dir)
    fnames_dermnet = fnames_train + fnames_test #we are doing SSL so we can use all the data

    fnames = fnames_isic+fnames_ufes+fnames_dermnet
    n = int(len(fnames)*pct_dataset)

    dls = ImageDataLoaders.from_path_func(
        path=".",
        fnames=fnames[0:n],
        label_func=lambda x: '',
        bs=bs,
        valid_pct=0,
        device=device,
        num_workers=num_workers*(device=='cuda')
                                          )
    return dls

